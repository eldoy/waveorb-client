!function(){var e=async function(e,n){var t,o,r,a,c,s=1,i=1e3,u=1001,d="$cbid";function f(s,i){o={},r=0,(t=new WebSocket(e)).onmessage=function(e){var t=JSON.parse(e.data),r=t[d];r?(delete t[d],o[r]&&(o[r](t,e),delete o[r])):n.onmessage&&n.onmessage(t,e)},t.onopen=function(e){s&&s(m),n.ping&&(clearInterval(a),clearTimeout(c),a=setInterval(function(){l({$ping:1})},n.ping),c=setTimeout(function(){clearInterval(a),p(u)},n.disconnect)),n.onopen&&n.onopen(m,e)},t.onerror=function(e){i&&i(e),n.onerror&&n.onerror(e)},t.onclose=function(e){n.reconnect&&setTimeout(f,n.reconnect),n.onclose&&n.onclose(e)}}function p(e){e=e||i,t.close(e)}function l(e){t.readyState===s&&t.send(JSON.stringify(e))}n||(n={}),void 0!==n.reconnect&&!0!==n.reconnect||(n.reconnect=1e3),!0===n.ping&&(n.ping=1e3),void 0===n.disconnect&&(n.disconnect=3e3);var m={connect:f,send:l,fetch:function(e){return new Promise(function(n){e[d]=++r,o[r]=function(e){n(e)},l(e)})},disconnect:p};return new Promise(f)};window.waveorb=function(n,t={}){return 0===n.indexOf("ws")?e(n,t):{fetch:function(e){return function(e,n){return new Promise(function(t,o){var r,a=new XMLHttpRequest;if(n||(n={}),!1!==n.async&&(n.async=!0),n.headers||(n.headers={}),n.params||(n.params={}),n.files){for(var c of(n.name||(n.name="file"),r=new FormData,n.files))r.append(n.name,c,c.name);n.progress&&a.upload.addEventListener("progress",function(e){e.percent=(e.loaded/e.total*100).toFixed(2),n.progress(e)}),n.headers["content-type"]||(n.headers["content-type"]="multipart/form-data")}else Object.keys(n.headers).map(function(e){return e.toLowerCase()}).includes("content-type")||(n.headers["content-type"]="application/json; charset=utf-8");for(var s in a.addEventListener("load",function(e){var n=JSON.parse(a.responseText);t(n)}),a.addEventListener("error",function(e){o(a)}),a.open(n.method||"post",e+(n.path||"/"),n.async),n.headers)a.setRequestHeader(s,n.headers[s]);var i=r||JSON.stringify(n.params);a.send(i)})}(n,{params:e})},upload:function(e,n={},t={}){return new Promise(function(o){upload(e,n,t,async function(e){o(await fetch(e,t))})})}}}}();